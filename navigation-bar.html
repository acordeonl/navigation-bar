<link rel="import" href="../polymer/polymer.html">
<!--

Shows drop down menu (works on chrome)

### Usage
The list displayed in the drop down menu can be set as an attribute.

    <drop-menu list-items='["first" ,"second"]'></drop-menu>

For an overlayed drop menu:

    <drop-menu overlay-menu list-items='["first" ,"second"]'></drop-menu>

### Styling
 Custom property | Description | Default
----------------|-------------|----------
`--item-background-color` | List item backround color | `#f1ecef`
`--item-color` | List item color used for fonts | `#302f31`
`--theme-color1` | Icon button hover color | `4775D1`
`--content-background` | Drop menu's background color | `white`
`--theme-color1` | Icon button hover color | `4775D1`
`--icon-button` | Mixin applied the icon button | `{}`

@demo demo/drop-menu-demo.html
-->
<dom-module id="navigation-bar">
    <template>
        <style>
            :host {
                --bar-color: var(--theme-color1,#4775D1);
                --knob-color: var(--theme-color10,#3F69BC);
            }
            [navigation-container] {
                @apply(--shadow-elevation-3dp);
                @apply(--layout-horizontal);
                width: 100%;
                cursor: pointer;
                position: relative;
                background-color: var(--background-color,#efebe9);
                height: 50px;
            }
            [navigation-progress] {
                background-color: var(--bar-color);
                height: 50px;
                top: 0;
                border-right: 5px solid var(--knob-color);
            }
            [separator] {
                /*background-color: #d1d0d4 ;*/
                background-color: var(--background-color0,#D7D3D1);
                position: absolute;
                left: 20%;
                width: 5px;
                height: 50px;
            }
            [separator][other] {
                left: 40%;
            }
            [percentage] {
                position: absolute;
                top: 15px;
                font-size: 15px;
                color: white;
                font-weight: 400;
            }
            [start-time] {
                left: 10px;
                color: var(--content-background,#fafafa);
            }
            [end-time] {
                right: 10px;
                color: #a7a6ab;
            }
        </style>
        <div navigation-container title="[[title]]">
            <div navigation-progress on-track='_handleTrack' style$='width:[[progress]]%'></div>
            <div separator></div>
            <div separator other></div>
            <div percentage start-time>[[_computeMMSS(startTime)]]</div>
            <div percentage end-time>[[_computeMMSS(endTime)]]</div>
        </div>
    </template>
    <script>
        Polymer({
            is: "navigation-bar",
            observers: [],
            behaviors: [],
            listeners: {'click':'_setProgress','mousemove':'_showTime'},
            properties: {
                title:{
                    type:Number,
                    value:0
                },
                startTime:{
                    type:Number,
                    value:0
                },
                endTime:{
                    type:Number,
                    value:0
                },
                progress:{
                    type:Number,
                    value:0
                },
                firingProgress:{
                    type:Boolean,
                    value:false
                }
            },
            _showTime: function(e){
                this.title = this._computeMMSS( (e.x/window.innerWidth)*(this.endTime-this.startTime) + this.startTime ) ;
            },
            _computeTitleMMSS: function(progress){
                var tmp = (progress/100)*(this.endTime-this.startTime) + this.startTime ;
                return this._computeMMSS(tmp) ;
            },
            _computeMMSS: function(time){
                var minutes = Math.floor(time/60) ;
                var seconds = Math.floor((time-(minutes*60))) ;
                if( seconds < 10 )
                    return minutes+':0'+seconds ;
                else
                    return minutes+':'+seconds ;
            },
            _handleTrack: function(e) {
                if(!this.firingProgress){
                    this.firingProgress = true ;
                    this.fire('set-nav-progress',{progress:e.detail.x/window.innerWidth*100}) ;
                    this.async(function(){
                        this.firingProgress = false ;
                    } ,  100 )  ;
                }
           },
           _setProgress: function(e){
                if(!this.firingProgress){
                    this.firingProgress = true ;
                    this.fire('set-nav-progress',{progress:e.clientX/window.innerWidth*100}) ;
                    this.async(function(){
                        this.firingProgress = false ;
                    } ,  100 )  ;
                }
            }
        });
    </script>
</dom-module>
